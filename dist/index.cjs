"use strict";var m=Object.defineProperty;var v=(t,r,e)=>r in t?m(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var u=(t,r,e)=>v(t,typeof r!="symbol"?r+"":r,e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function l(t){const r={},e=t.$select;e&&(r.select=e.split(",").map(s=>s.trim()).filter(Boolean));const n=t.$orderby;n&&(r.orderby=n.split(",").map(s=>{const[p,y]=s.trim().split(/\s+/);return{property:p,direction:y?.toLowerCase()==="desc"?"desc":"asc"}}));const a=t.$top;a!==void 0&&(r.top=Math.max(0,Number(a)));const o=t.$skip;o!==void 0&&(r.skip=Math.max(0,Number(o)));const i=t.$count;i!==void 0&&(r.count=String(i).toLowerCase()==="true");const c=t.$filter;c&&(r.filter=c);const d=t.$expand;return d&&(r.expand=Object.fromEntries(d.split(",").map(s=>[s.trim(),{}]))),r}function b(t){return{before:async r=>{const e=r.event??{},n=e.rawQueryString?Object.fromEntries(new URLSearchParams(e.rawQueryString)):e.queryStringParameters||{},a=l(n),o=typeof t.serviceRoot=="function"?t.serviceRoot(e):t.serviceRoot,i={model:t.model,serviceRoot:o,entitySet:void 0,options:a};r.internal=r.internal||{},r.internal.odata=i}}}class g extends Error{constructor(){super(...arguments);u(this,"statusCode",400);u(this,"code","BadRequest")}}class S extends Error{constructor(){super(...arguments);u(this,"statusCode",500);u(this,"code","InternalServerError")}}function x(t,r){if(t&&typeof t=="object"&&"statusCode"in t&&"message"in t){const e=t;return{error:{code:e.code??String(e.statusCode),message:e.message}}}return{error:{code:"InternalServerError",message:r??"An error occurred"}}}function f(t,r){if(!r||r.length===0)return{...t};const e={};for(const n of r)n in t&&(e[n]=t[n]);return e}function O(t,r){return t.map(e=>f(e,r.select))}function D(t,r){return t}function E(t,r){return r.filter,t}function A(t,r){if(!r.orderby||r.orderby.length===0)return t;const e=[...t];return e.sort((n,a)=>{for(const o of r.orderby){const i=n[o.property],c=a[o.property];if(!(i==null&&c==null)){if(i==null)return o.direction==="asc"?-1:1;if(c==null)return o.direction==="asc"?1:-1;if(i<c)return o.direction==="asc"?-1:1;if(i>c)return o.direction==="asc"?1:-1}}return 0}),e}function C(t,r){const e=r.skip??0,n=r.top??t.length;return t.slice(e,e+n)}function R(t,r,e,n){const a={"@odata.context":t,value:r};return typeof e=="number"&&(a["@odata.count"]=e),n&&(a["@odata.nextLink"]=n),a}exports.ODataBadRequest=g;exports.ODataInternalServerError=S;exports.applySelect=f;exports.expandData=D;exports.filterArray=E;exports.odata=b;exports.orderArray=A;exports.paginateArray=C;exports.parseODataQuery=l;exports.projectArray=O;exports.serializeCollection=R;exports.toODataError=x;
//# sourceMappingURL=index.cjs.map
