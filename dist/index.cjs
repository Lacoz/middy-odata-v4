"use strict";var m=Object.defineProperty;var v=(r,t,e)=>t in r?m(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var u=(r,t,e)=>v(r,typeof t!="symbol"?t+"":t,e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function d(r){const t={},e=r.$select;e&&(t.select=e.split(",").map(s=>s.trim()).filter(Boolean));const o=r.$orderby;o&&(t.orderby=o.split(",").map(s=>{const[p,y]=s.trim().split(/\s+/);return{property:p,direction:y?.toLowerCase()==="desc"?"desc":"asc"}}));const a=r.$top;a!==void 0&&(t.top=Math.max(0,Number(a)));const n=r.$skip;n!==void 0&&(t.skip=Math.max(0,Number(n)));const i=r.$count;i!==void 0&&(t.count=String(i).toLowerCase()==="true");const c=r.$filter;c&&(t.filter=c);const l=r.$expand;return l&&(t.expand=Object.fromEntries(l.split(",").map(s=>[s.trim(),{}]))),t}function b(r){return{before:async t=>{const e=t.event??{},o=e.rawQueryString?Object.fromEntries(new URLSearchParams(e.rawQueryString)):e.queryStringParameters||{},a=d(o),n=typeof r.serviceRoot=="function"?r.serviceRoot(e):r.serviceRoot,i={model:r.model,serviceRoot:n,entitySet:void 0,options:a};t.internal=t.internal||{},t.internal.odata=i}}}class g extends Error{constructor(){super(...arguments);u(this,"statusCode",400);u(this,"code","BadRequest")}}class S extends Error{constructor(){super(...arguments);u(this,"statusCode",500);u(this,"code","InternalServerError")}}function O(r,t){if(r&&typeof r=="object"&&"statusCode"in r&&"message"in r){const e=r;return{error:{code:e.code??String(e.statusCode),message:e.message}}}return{error:{code:"InternalServerError",message:t??"An error occurred"}}}function f(r,t){if(!t||t.length===0)return{...r};const e={};for(const o of t)o in r&&(e[o]=r[o]);return e}function E(r,t){return r.map(e=>f(e,t.select))}function x(r,t){return t.filter,r}function A(r,t){if(!t.orderby||t.orderby.length===0)return r;const e=[...r];return e.sort((o,a)=>{for(const n of t.orderby){const i=o[n.property],c=a[n.property];if(!(i==null&&c==null)){if(i==null)return n.direction==="asc"?-1:1;if(c==null)return n.direction==="asc"?1:-1;if(i<c)return n.direction==="asc"?-1:1;if(i>c)return n.direction==="asc"?1:-1}}return 0}),e}function C(r,t){const e=t.skip??0,o=t.top??r.length;return r.slice(e,e+o)}function D(r,t,e,o){const a={"@odata.context":r,value:t};return typeof e=="number"&&(a["@odata.count"]=e),o&&(a["@odata.nextLink"]=o),a}exports.ODataBadRequest=g;exports.ODataInternalServerError=S;exports.applySelect=f;exports.filterArray=x;exports.odata=b;exports.orderArray=A;exports.paginateArray=C;exports.parseODataQuery=d;exports.projectArray=E;exports.serializeCollection=D;exports.toODataError=O;
//# sourceMappingURL=index.cjs.map
